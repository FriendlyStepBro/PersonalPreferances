"use strict";(globalThis.webpackChunkproton_pass_extension=globalThis.webpackChunkproton_pass_extension||[]).push([["node_modules_pmcrypto-v6-canary_node_modules_openpgp_dist_lightweight_noble_curves_min_mjs"],{46504:(t,e,r)=>{r.d(e,{nobleCurves:()=>t1});var n=r(33558);/*! OpenPGP.js v6.0.0-beta.3.patch.1 - 2024-09-11 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;class i extends n.H{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,n.h)(t);let r=(0,n.t)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,f=new Uint8Array(i);f.set(r.length>i?t.create().update(r).digest():r);for(let t=0;t<f.length;t++)f[t]^=54;this.iHash.update(f),this.oHash=t.create();for(let t=0;t<f.length;t++)f[t]^=106;this.oHash.update(f),f.fill(0)}update(t){return(0,n.e)(this),this.iHash.update(t),this}digestInto(t){(0,n.e)(this),(0,n.b)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:f,outputLen:o}=this;return t.finished=n,t.destroyed=i,t.blockLen=f,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let f=(t,e,r)=>new i(t,e).update(r).digest();f.create=(t,e)=>new i(t,e)/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */;let o=BigInt(0),s=BigInt(1),a=BigInt(2);function l(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}function d(t){if(!l(t))throw Error("Uint8Array expected")}function h(t,e){if("boolean"!=typeof e)throw Error(`${t} must be valid boolean, got "${e}".`)}let c=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function u(t){d(t);let e="";for(let r=0;r<t.length;r++)e+=c[t[r]];return e}function b(t){let e=t.toString(16);return 1&e.length?"0"+e:e}function g(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":"0x"+t)}let p={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function y(t){return t>=p._0&&t<=p._9?t-p._0:t>=p._A&&t<=p._F?t-(p._A-10):t>=p._a&&t<=p._f?t-(p._a-10):void 0}function w(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){let r=y(t.charCodeAt(i)),f=y(t.charCodeAt(i+1));if(void 0===r||void 0===f)throw Error('hex string expected, got non-hex character "'+(t[i]+t[i+1])+'" at index '+i);n[e]=16*r+f}return n}function B(t){return g(u(t))}function x(t){return d(t),g(u(Uint8Array.from(t).reverse()))}function m(t,e){return w(t.toString(16).padStart(2*e,"0"))}function E(t,e){return m(t,e).reverse()}function I(t,e,r){let n;if("string"==typeof e)try{n=w(e)}catch(r){throw Error(`${t} must be valid hex string, got "${e}". Cause: ${r}`)}else{if(!l(e))throw Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}let i=n.length;if("number"==typeof r&&i!==r)throw Error(`${t} expected ${r} bytes, got ${i}`);return n}function v(...t){let e=0;for(let r=0;r<t.length;r++){let n=t[r];d(n),e+=n.length}let r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let i=t[e];r.set(i,n),n+=i.length}return r}let S=t=>"bigint"==typeof t&&o<=t;function A(t,e,r){return S(t)&&S(e)&&S(r)&&e<=t&&t<r}function L(t,e,r,n){if(!A(e,r,n))throw Error(`expected valid ${t}: ${r} <= n < ${n}, got ${typeof e} ${e}`)}function O(t){let e;for(e=0;t>o;t>>=s,e+=1);return e}let H=t=>(a<<BigInt(t-1))-s,R=t=>new Uint8Array(t),k=t=>Uint8Array.from(t);function F(t,e,r){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let n=R(t),i=R(t),f=0,o=()=>{n.fill(1),i.fill(0),f=0},s=(...t)=>r(i,n,...t),a=(t=R())=>{i=s(k([0]),t),n=s(),0!==t.length&&(i=s(k([1]),t),n=s())},l=()=>{if(f++>=1e3)throw Error("drbg: tried 1000 values");let t=0,r=[];for(;t<e;){let e=(n=s()).slice();r.push(e),t+=n.length}return v(...r)};return(t,e)=>{let r;for(o(),a(t);!(r=e(l()));)a();return o(),r}}let U={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||l(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function q(t,e,r={}){let n=(e,r,n)=>{let i=U[r];if("function"!=typeof i)throw Error(`Invalid validator "${r}", expected function`);let f=t[e];if(!(n&&void 0===f||i(f,t)))throw Error(`Invalid param ${e+""}=${f} (${typeof f}), expected ${r}`)};for(let[t,r]of Object.entries(e))n(t,r,!1);for(let[t,e]of Object.entries(r))n(t,e,!0);return t}function z(t){let e=new WeakMap;return(r,...n)=>{let i=e.get(r);if(void 0!==i)return i;let f=t(r,...n);return e.set(r,f),f}}var C=Object.freeze({__proto__:null,aInRange:L,abool:h,abytes:d,bitGet:function(t,e){return t>>BigInt(e)&s},bitLen:O,bitMask:H,bitSet:function(t,e,r){return t|(r?s:o)<<BigInt(e)},bytesToHex:u,bytesToNumberBE:B,bytesToNumberLE:x,concatBytes:v,createHmacDrbg:F,ensureBytes:I,equalBytes:function(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return 0===r},hexToBytes:w,hexToNumber:g,inRange:A,isBytes:l,memoized:z,notImplemented:()=>{throw Error("not implemented")},numberToBytesBE:m,numberToBytesLE:E,numberToHexUnpadded:b,numberToVarBytesBE:function(t){return w(b(t))},utf8ToBytes:function(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))},validateObject:q});/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let N=BigInt(0),_=BigInt(1),G=BigInt(2),P=BigInt(3),T=BigInt(4),$=BigInt(5),Z=BigInt(8);function j(t,e){let r=t%e;return r>=N?r:e+r}function D(t,e,r){if(r<=N||e<N)throw Error("Expected power/modulo > 0");if(r===_)return N;let n=_;for(;e>N;)e&_&&(n=n*t%r),t=t*t%r,e>>=_;return n}function V(t,e,r){let n=t;for(;e-- >N;)n*=n,n%=r;return n}function K(t,e){if(t===N||e<=N)throw Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=j(t,e),n=e,i=N,f=_;for(;r!==N;){let t=n%r,e=i-n/r*f;n=r,r=t,i=f,f=e}if(n!==_)throw Error("invert: does not exist");return j(i,e)}BigInt(9),BigInt(16);let M=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Y(t,e){let r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function W(t,e,r=!1,n={}){if(t<=N)throw Error("Expected Field ORDER > 0, got "+t);let{nBitLength:i,nByteLength:f}=Y(t,e);if(f>2048)throw Error("Field lengths over 2048 bytes are not supported");let o=function(t){if(t%T===P){let e=(t+_)/T;return function(t,r){let n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw Error("Cannot find square root");return n}}if(t%Z===$){let e=(t-$)/Z;return function(t,r){let n=t.mul(r,G),i=t.pow(n,e),f=t.mul(r,i),o=t.mul(t.mul(f,G),i),s=t.mul(f,t.sub(o,t.ONE));if(!t.eql(t.sqr(s),r))throw Error("Cannot find square root");return s}}return function(t){let e,r,n;let i=(t-_)/G;for(e=t-_,r=0;e%G===N;e/=G,r++);for(n=G;n<t&&D(n,i,t)!==t-_;n++);if(1===r){let e=(t+_)/T;return function(t,r){let n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw Error("Cannot find square root");return n}}let f=(e+_)/G;return function(t,o){if(t.pow(o,i)===t.neg(t.ONE))throw Error("Cannot find square root");let s=r,a=t.pow(t.mul(t.ONE,n),e),l=t.pow(o,f),d=t.pow(o,e);for(;!t.eql(d,t.ONE);){if(t.eql(d,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(d);e<s&&!t.eql(r,t.ONE);e++)r=t.sqr(r);let r=t.pow(a,_<<BigInt(s-e-1));a=t.sqr(r),l=t.mul(l,r),d=t.mul(d,a),s=e}return l}}(t)}(t),s=Object.freeze({ORDER:t,BITS:i,BYTES:f,MASK:H(i),ZERO:N,ONE:_,create:e=>j(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error("Invalid field element: expected bigint, got "+typeof e);return N<=e&&e<t},is0:t=>t===N,isOdd:t=>(t&_)===_,neg:e=>j(-e,t),eql:(t,e)=>t===e,sqr:e=>j(e*e,t),add:(e,r)=>j(e+r,t),sub:(e,r)=>j(e-r,t),mul:(e,r)=>j(e*r,t),pow:(t,e)=>(function(t,e,r){if(r<N)throw Error("Expected power > 0");if(r===N)return t.ONE;if(r===_)return e;let n=t.ONE,i=e;for(;r>N;)r&_&&(n=t.mul(n,i)),i=t.sqr(i),r>>=_;return n})(s,t,e),div:(e,r)=>j(e*K(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>K(e,t),sqrt:n.sqrt||(t=>o(s,t)),invertBatch:t=>(function(t,e){let r=Array(e.length),n=e.reduce((e,n,i)=>t.is0(n)?e:(r[i]=e,t.mul(e,n)),t.ONE),i=t.inv(n);return e.reduceRight((e,n,i)=>t.is0(n)?e:(r[i]=t.mul(e,r[i]),t.mul(e,n)),i),r})(s,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>r?E(t,f):m(t,f),fromBytes:t=>{if(t.length!==f)throw Error(`Fp.fromBytes: expected ${f}, got ${t.length}`);return r?x(t):B(t)}});return Object.freeze(s)}function X(t){if("bigint"!=typeof t)throw Error("field order must be bigint");return Math.ceil(t.toString(2).length/8)}function J(t){let e=X(t);return e+Math.ceil(e/2)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let Q=BigInt(0),tt=BigInt(1),te=new WeakMap,tr=new WeakMap;function tn(t,e){let r=(t,e)=>{let r=e.negate();return t?r:e},n=t=>{if(!Number.isSafeInteger(t)||t<=0||t>e)throw Error(`Wrong window size=${t}, should be [1..${e}]`)},i=t=>(n(t),{windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:r,unsafeLadder(e,r){let n=t.ZERO,i=e;for(;r>Q;)r&tt&&(n=n.add(i)),i=i.double(),r>>=tt;return n},precomputeWindow(t,e){let{windows:r,windowSize:n}=i(e),f=[],o=t,s=o;for(let t=0;t<r;t++){s=o,f.push(s);for(let t=1;t<n;t++)s=s.add(o),f.push(s);o=s.double()}return f},wNAF(e,n,f){let{windows:o,windowSize:s}=i(e),a=t.ZERO,l=t.BASE,d=BigInt(2**e-1),h=2**e,c=BigInt(e);for(let t=0;t<o;t++){let e=t*s,i=Number(f&d);f>>=c,i>s&&(i-=h,f+=tt);let o=e+Math.abs(i)-1,u=t%2!=0,b=i<0;0===i?l=l.add(r(u,n[e])):a=a.add(r(b,n[o]))}return{p:a,f:l}},wNAFCached(t,e,r){let n=tr.get(t)||1,i=te.get(t);return i||(i=this.precomputeWindow(t,n),1!==n&&te.set(t,r(i))),this.wNAF(n,i,e)},setWindowSize(t,e){n(e),tr.set(t,e),te.delete(t)}}}function ti(t,e,r,n){if(!Array.isArray(r)||!Array.isArray(n)||n.length!==r.length)throw Error("arrays of points and scalars must have equal length");n.forEach((t,r)=>{if(!e.isValid(t))throw Error("wrong scalar at index "+r)}),r.forEach((e,r)=>{if(!(e instanceof t))throw Error("wrong point at index "+r)});let i=O(BigInt(r.length)),f=i>12?i-3:i>4?i-2:i?2:1,o=(1<<f)-1,s=Array(o+1).fill(t.ZERO),a=Math.floor((e.BITS-1)/f)*f,l=t.ZERO;for(let e=a;e>=0;e-=f){s.fill(t.ZERO);for(let t=0;t<n.length;t++){let i=Number(n[t]>>BigInt(e)&BigInt(o));s[i]=s[i].add(r[t])}let i=t.ZERO;for(let e=s.length-1,r=t.ZERO;e>0;e--)r=r.add(s[e]),i=i.add(r);if(l=l.add(i),0!==e)for(let t=0;t<f;t++)l=l.double()}return l}function tf(t){return q(t.Fp,M.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),q(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Y(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function to(t){void 0!==t.lowS&&h("lowS",t.lowS),void 0!==t.prehash&&h("prehash",t.prehash)}let{bytesToNumberBE:ts,hexToBytes:ta}=C,tl={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(t,e)=>{let{Err:r}=tl;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");let n=e.length/2,i=b(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");let f=n>127?b(i.length/2|128):"";return`${b(t)}${f}${i}${e}`},decode(t,e){let{Err:r}=tl,n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");let i=e[n++],f=0;if(128&i){let t=127&i;if(!t)throw new r("tlv.decode(long): indefinite length not supported");if(t>4)throw new r("tlv.decode(long): byte length is too big");let o=e.subarray(n,n+t);if(o.length!==t)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(let t of o)f=f<<8|t;if(n+=t,f<128)throw new r("tlv.decode(long): not minimal encoding")}else f=i;let o=e.subarray(n,n+f);if(o.length!==f)throw new r("tlv.decode: wrong value length");return{v:o,l:e.subarray(n+f)}}},_int:{encode(t){let{Err:e}=tl;if(t<td)throw new e("integer: negative integers are not allowed");let r=b(t);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected assertion");return r},decode(t){let{Err:e}=tl;if(128&t[0])throw new e("Invalid signature integer: negative");if(0===t[0]&&!(128&t[1]))throw new e("Invalid signature integer: unnecessary leading zero");return ts(t)}},toSig(t){let{Err:e,_int:r,_tlv:n}=tl,i="string"==typeof t?ta(t):t;d(i);let{v:f,l:o}=n.decode(48,i);if(o.length)throw new e("Invalid signature: left bytes after parsing");let{v:s,l:a}=n.decode(2,f),{v:l,l:h}=n.decode(2,a);if(h.length)throw new e("Invalid signature: left bytes after parsing");return{r:r.decode(s),s:r.decode(l)}},hexFromSig(t){let{_tlv:e,_int:r}=tl,n=`${e.encode(2,r.encode(t.r))}${e.encode(2,r.encode(t.s))}`;return e.encode(48,n)}},td=BigInt(0),th=BigInt(1);BigInt(2);let tc=BigInt(3);function tu(t,e){let r=e=>(function(t){let e=function(t){let e=tf(t);return q(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:r,n:n}=e,i=r.BYTES+1,f=2*r.BYTES+1;function o(t){return j(t,n)}let{ProjectivePoint:s,normPrivateKeyToScalar:a,weierstrassEquation:d,isWithinCurveOrder:c}=function(t){let e=function(t){let e=tf(t);q(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,n=W(e.n,e.nBitLength),i=e.toBytes||((t,e,n)=>{let i=e.toAffine();return v(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),f=e.fromBytes||(t=>{let e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function o(t){let{a:n,b:i}=e,f=r.sqr(t),o=r.mul(f,t);return r.add(r.add(o,r.mul(t,n)),i)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw Error("bad generator point: equation left != right");function s(t){let r;let{allowedPrivateKeyLengths:n,nByteLength:i,wrapPrivateKey:f,n:o}=e;if(n&&"bigint"!=typeof t){if(l(t)&&(t=u(t)),"string"!=typeof t||!n.includes(t.length))throw Error("Invalid key");t=t.padStart(2*i,"0")}try{r="bigint"==typeof t?t:B(I("private key",t,i))}catch(e){throw Error(`private key must be ${i} bytes, hex or bigint, not ${typeof t}`)}return f&&(r=j(r,o)),L("private key",r,th,o),r}function a(t){if(!(t instanceof b))throw Error("ProjectivePoint expected")}let d=z((t,e)=>{let{px:n,py:i,pz:f}=t;if(r.eql(f,r.ONE))return{x:n,y:i};let o=t.is0();null==e&&(e=o?r.ONE:r.inv(f));let s=r.mul(n,e),a=r.mul(i,e),l=r.mul(f,e);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(l,r.ONE))throw Error("invZ was invalid");return{x:s,y:a}}),c=z(t=>{if(t.is0()){if(e.allowInfinityPoint&&!r.is0(t.py))return;throw Error("bad point: ZERO")}let{x:n,y:i}=t.toAffine();if(!r.isValid(n)||!r.isValid(i))throw Error("bad point: x or y not FE");let f=r.sqr(i),s=o(n);if(!r.eql(f,s))throw Error("bad point: equation left != right");if(!t.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class b{constructor(t,e,n){if(this.px=t,this.py=e,this.pz=n,null==t||!r.isValid(t))throw Error("x required");if(null==e||!r.isValid(e))throw Error("y required");if(null==n||!r.isValid(n))throw Error("z required");Object.freeze(this)}static fromAffine(t){let{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw Error("invalid affine point");if(t instanceof b)throw Error("projective point not allowed");let i=t=>r.eql(t,r.ZERO);return i(e)&&i(n)?b.ZERO:new b(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){let e=r.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(b.fromAffine)}static fromHex(t){let e=b.fromAffine(f(I("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return b.BASE.multiply(s(t))}static msm(t,e){return ti(b,n,t,e)}_setWindowSize(t){p.setWindowSize(this,t)}assertValidity(){c(this)}hasEvenY(){let{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw Error("Field doesn't support isOdd")}equals(t){a(t);let{px:e,py:n,pz:i}=this,{px:f,py:o,pz:s}=t,l=r.eql(r.mul(e,s),r.mul(f,i)),d=r.eql(r.mul(n,s),r.mul(o,i));return l&&d}negate(){return new b(this.px,r.neg(this.py),this.pz)}double(){let{a:t,b:n}=e,i=r.mul(n,tc),{px:f,py:o,pz:s}=this,a=r.ZERO,l=r.ZERO,d=r.ZERO,h=r.mul(f,f),c=r.mul(o,o),u=r.mul(s,s),g=r.mul(f,o);return g=r.add(g,g),d=r.mul(f,s),d=r.add(d,d),a=r.mul(t,d),l=r.mul(i,u),l=r.add(a,l),a=r.sub(c,l),l=r.add(c,l),l=r.mul(a,l),a=r.mul(g,a),d=r.mul(i,d),u=r.mul(t,u),g=r.sub(h,u),g=r.mul(t,g),g=r.add(g,d),d=r.add(h,h),h=r.add(d,h),h=r.add(h,u),h=r.mul(h,g),l=r.add(l,h),u=r.mul(o,s),u=r.add(u,u),h=r.mul(u,g),a=r.sub(a,h),d=r.mul(u,c),d=r.add(d,d),new b(a,l,d=r.add(d,d))}add(t){a(t);let{px:n,py:i,pz:f}=this,{px:o,py:s,pz:l}=t,d=r.ZERO,h=r.ZERO,c=r.ZERO,u=e.a,g=r.mul(e.b,tc),p=r.mul(n,o),y=r.mul(i,s),w=r.mul(f,l),B=r.add(n,i),x=r.add(o,s);B=r.mul(B,x),x=r.add(p,y),B=r.sub(B,x),x=r.add(n,f);let m=r.add(o,l);return x=r.mul(x,m),m=r.add(p,w),x=r.sub(x,m),m=r.add(i,f),d=r.add(s,l),m=r.mul(m,d),d=r.add(y,w),m=r.sub(m,d),c=r.mul(u,x),d=r.mul(g,w),c=r.add(d,c),d=r.sub(y,c),c=r.add(y,c),h=r.mul(d,c),y=r.add(p,p),y=r.add(y,p),w=r.mul(u,w),x=r.mul(g,x),y=r.add(y,w),w=r.sub(p,w),w=r.mul(u,w),x=r.add(x,w),p=r.mul(y,x),h=r.add(h,p),p=r.mul(m,x),d=r.mul(B,d),d=r.sub(d,p),p=r.mul(B,y),c=r.mul(m,c),new b(d,h,c=r.add(c,p))}subtract(t){return this.add(t.negate())}is0(){return this.equals(b.ZERO)}wNAF(t){return p.wNAFCached(this,t,b.normalizeZ)}multiplyUnsafe(t){L("scalar",t,td,e.n);let n=b.ZERO;if(t===td)return n;if(t===th)return this;let{endo:i}=e;if(!i)return p.unsafeLadder(this,t);let{k1neg:f,k1:o,k2neg:s,k2:a}=i.splitScalar(t),l=n,d=n,h=this;for(;o>td||a>td;)o&th&&(l=l.add(h)),a&th&&(d=d.add(h)),h=h.double(),o>>=th,a>>=th;return f&&(l=l.negate()),s&&(d=d.negate()),d=new b(r.mul(d.px,i.beta),d.py,d.pz),l.add(d)}multiply(t){let n,i;let{endo:f,n:o}=e;if(L("scalar",t,th,o),f){let{k1neg:e,k1:o,k2neg:s,k2:a}=f.splitScalar(t),{p:l,f:d}=this.wNAF(o),{p:h,f:c}=this.wNAF(a);l=p.constTimeNegate(e,l),h=p.constTimeNegate(s,h),h=new b(r.mul(h.px,f.beta),h.py,h.pz),n=l.add(h),i=d.add(c)}else{let{p:e,f:r}=this.wNAF(t);n=e,i=r}return b.normalizeZ([n,i])[0]}multiplyAndAddUnsafe(t,e,r){let n=b.BASE,i=(t,e)=>e!==td&&e!==th&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),f=i(this,e).add(i(t,r));return f.is0()?void 0:f}toAffine(t){return d(this,t)}isTorsionFree(){let{h:t,isTorsionFree:r}=e;if(t===th)return!0;if(r)return r(b,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:t,clearCofactor:r}=e;return t===th?this:r?r(b,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return h("isCompressed",t),this.assertValidity(),i(b,this,t)}toHex(t=!0){return h("isCompressed",t),u(this.toRawBytes(t))}}b.BASE=new b(e.Gx,e.Gy,r.ONE),b.ZERO=new b(r.ZERO,r.ONE,r.ZERO);let g=e.nBitLength,p=tn(b,e.endo?Math.ceil(g/2):g);return{CURVE:e,ProjectivePoint:b,normPrivateKeyToScalar:s,weierstrassEquation:o,isWithinCurveOrder:function(t){return A(t,th,e.n)}}}({...e,toBytes(t,e,n){let i=e.toAffine(),f=r.toBytes(i.x);return h("isCompressed",n),n?v(Uint8Array.from([e.hasEvenY()?2:3]),f):v(Uint8Array.from([4]),f,r.toBytes(i.y))},fromBytes(t){let e=t.length,n=t[0],o=t.subarray(1);if(e!==i||2!==n&&3!==n){if(e===f&&4===n)return{x:r.fromBytes(o.subarray(0,r.BYTES)),y:r.fromBytes(o.subarray(r.BYTES,2*r.BYTES))};throw Error(`Point of length ${e} was invalid. Expected ${i} compressed bytes or ${f} uncompressed bytes`)}{let t;let e=B(o);if(!A(e,th,r.ORDER))throw Error("Point is not on curve");let i=d(e);try{t=r.sqrt(i)}catch(t){throw Error("Point is not on curve"+(t instanceof Error?": "+t.message:""))}return!(1&~n)!=((t&th)===th)&&(t=r.neg(t)),{x:e,y:t}}}}),b=t=>u(m(t,e.nByteLength)),g=(t,e,r)=>B(t.slice(e,r));class p{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){let r=e.nByteLength;return new p(g(t=I("compactSignature",t,2*r),0,r),g(t,r,2*r))}static fromDER(t){let{r:e,s:r}=tl.toSig(I("DER",t));return new p(e,r)}assertValidity(){L("r",this.r,th,n),L("s",this.s,th,n)}addRecoveryBit(t){return new p(this.r,this.s,t)}recoverPublicKey(t){let{r:i,s:f,recovery:a}=this,l=O(I("msgHash",t));if(null==a||![0,1,2,3].includes(a))throw Error("recovery id invalid");let d=2===a||3===a?i+e.n:i;if(d>=r.ORDER)throw Error("recovery id 2 or 3 invalid");let h=1&a?"03":"02",c=s.fromHex(h+b(d)),u=K(d,n),g=o(-l*u),p=o(f*u),y=s.BASE.multiplyAndAddUnsafe(c,g,p);if(!y)throw Error("point at infinify");return y.assertValidity(),y}hasHighS(){return this.s>n>>th}normalizeS(){return this.hasHighS()?new p(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return w(this.toDERHex())}toDERHex(){return tl.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return w(this.toCompactHex())}toCompactHex(){return b(this.r)+b(this.s)}}function y(t){let e=l(t),r="string"==typeof t,n=(e||r)&&t.length;return e?n===i||n===f:r?n===2*i||n===2*f:t instanceof s}let S=e.bits2int||function(t){let r=B(t),n=8*t.length-e.nBitLength;return n>0?r>>BigInt(n):r},O=e.bits2int_modN||function(t){return o(S(t))},R=H(e.nBitLength);function k(t){return L("num < 2^"+e.nBitLength,t,td,R),m(t,e.nByteLength)}let U={lowS:e.lowS,prehash:!1},C={lowS:e.lowS,prehash:!1};return s.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return s.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(y(t))throw Error("first arg must be private key");if(!y(e))throw Error("second arg must be public key");return s.fromHex(e).multiply(a(t)).toRawBytes(r)},sign:function(t,i,f=U){let{seed:l,k2sig:d}=function(t,i,f=U){if(["recovered","canonical"].some(t=>t in f))throw Error("sign() legacy options not supported");let{hash:l,randomBytes:d}=e,{lowS:h,prehash:u,extraEntropy:b}=f;null==h&&(h=!0),t=I("msgHash",t),to(f),u&&(t=I("prehashed msgHash",l(t)));let g=O(t),y=a(i),w=[k(y),k(g)];if(null!=b&&!1!==b){let t=!0===b?d(r.BYTES):b;w.push(I("extraEntropy",t))}return{seed:v(...w),k2sig:function(t){let e=S(t);if(!c(e))return;let r=K(e,n),i=s.BASE.multiply(e).toAffine(),f=o(i.x);if(f===td)return;let a=o(r*o(g+f*y));if(a===td)return;let l=(i.x===f?0:2)|Number(i.y&th),d=a;return h&&a>n>>th&&(d=a>n>>th?o(-a):a,l^=1),new p(f,d,l)}}}(t,i,f);return F(e.hash.outputLen,e.nByteLength,e.hmac)(l,d)},verify:function(t,r,i,f=C){let a,d;if(r=I("msgHash",r),i=I("publicKey",i),"strict"in f)throw Error("options.strict was renamed to lowS");to(f);let{lowS:h,prehash:c}=f;try{if("string"==typeof t||l(t))try{a=p.fromDER(t)}catch(e){if(!(e instanceof tl.Err))throw e;a=p.fromCompact(t)}else{if("object"!=typeof t||"bigint"!=typeof t.r||"bigint"!=typeof t.s)throw Error("PARSE");{let{r:e,s:r}=t;a=new p(e,r)}}d=s.fromHex(i)}catch(t){if("PARSE"===t.message)throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(h&&a.hasHighS())return!1;c&&(r=e.hash(r));let{r:u,s:b}=a,g=O(r),y=K(b,n),w=o(g*y),B=o(u*y),x=s.BASE.multiplyAndAddUnsafe(d,w,B)?.toAffine();return!!x&&o(x.x)===u},ProjectivePoint:s,Signature:p,utils:{isValidPrivateKey(t){try{return a(t),!0}catch(t){return!1}},normPrivateKeyToScalar:a,randomPrivateKey:()=>{let t=J(e.n);return function(t,e,r=!1){let n=t.length,i=X(e),f=J(e);if(n<16||n<f||n>1024)throw Error(`expected ${f}-1024 bytes of input, got ${n}`);let o=j(r?B(t):x(t),e-_)+_;return r?E(o,i):m(o,i)}(e.randomBytes(t),e.n)},precompute:(t=8,e=s.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}})({...t,hash:e,hmac:(t,...r)=>f(e,t,(0,n.c)(...r)),randomBytes:n.r});return Object.freeze({...r(e),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */BigInt(4);let tb=W(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),tg=tu({a:tb.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:tb,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},n.s),tp=W(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),ty=tu({a:tp.create(BigInt("-3")),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:tp,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},n.a),tw=W(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),tB={a:tw.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:tw,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},tx=tu({a:tB.a,b:tB.b,Fp:tw,n:tB.n,Gx:tB.Gx,Gy:tB.Gy,h:tB.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},n.d),tm=BigInt(0),tE=BigInt(1),tI=BigInt(2),tv=BigInt(8),tS={zip215:!0},tA=BigInt(0),tL=BigInt(1),tO=(0,n.w)(()=>n.f.create({dkLen:114})),tH=((0,n.w)(()=>n.f.create({dkLen:64})),BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),tR=BigInt(1),tk=BigInt(2),tF=BigInt(3);BigInt(4);let tU=BigInt(11),tq=BigInt(22),tz=BigInt(44),tC=BigInt(88),tN=BigInt(223);function t_(t){let e=t*t*t%tH,r=e*e*t%tH,n=V(r,tF,tH)*r%tH,i=V(n,tF,tH)*r%tH,f=V(i,tk,tH)*e%tH,o=V(f,tU,tH)*f%tH,s=V(o,tq,tH)*o%tH,a=V(s,tz,tH)*s%tH,l=V(a,tC,tH)*a%tH,d=V(l,tz,tH)*s%tH,h=V(d,tk,tH)*e%tH,c=V(h,tR,tH)*t%tH;return V(c,tN,tH)*h%tH}function tG(t){return t[0]&=252,t[55]|=128,t[56]=0,t}let tP=W(tH,456,!0),tT=function(t){let e=function(t){let e=tf(t);return q(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:r,n:n,prehash:i,hash:f,randomBytes:o,nByteLength:s,h:a}=e,l=tI<<BigInt(8*s)-tE,d=r.create,c=W(e.n,e.nBitLength),b=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(t*r.inv(e))}}catch(t){return{isValid:!1,value:tm}}}),g=e.adjustScalarBytes||(t=>t),p=e.domain||((t,e,r)=>{if(h("phflag",r),e.length||r)throw Error("Contexts/pre-hash are not supported");return t});function y(t,e){L("coordinate "+t,e,tm,l)}function w(t){if(!(t instanceof S))throw Error("ExtendedPoint expected")}let B=z((t,e)=>{let{ex:n,ey:i,ez:f}=t,o=t.is0();null==e&&(e=o?tv:r.inv(f));let s=d(n*e),a=d(i*e),l=d(f*e);if(o)return{x:tm,y:tE};if(l!==tE)throw Error("invZ was invalid");return{x:s,y:a}}),m=z(t=>{let{a:r,d:n}=e;if(t.is0())throw Error("bad point: ZERO");let{ex:i,ey:f,ez:o,et:s}=t,a=d(i*i),l=d(f*f),h=d(o*o),c=d(h*h),u=d(a*r);if(d(h*d(u+l))!==d(c+d(n*d(a*l))))throw Error("bad point: equation left != right (1)");if(d(i*f)!==d(o*s))throw Error("bad point: equation left != right (2)");return!0});class S{constructor(t,e,r,n){this.ex=t,this.ey=e,this.ez=r,this.et=n,y("x",t),y("y",e),y("z",r),y("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof S)throw Error("extended point not allowed");let{x:e,y:r}=t||{};return y("x",e),y("y",r),new S(e,r,tE,d(e*r))}static normalizeZ(t){let e=r.invertBatch(t.map(t=>t.ez));return t.map((t,r)=>t.toAffine(e[r])).map(S.fromAffine)}static msm(t,e){return ti(S,c,t,e)}_setWindowSize(t){H.setWindowSize(this,t)}assertValidity(){m(this)}equals(t){w(t);let{ex:e,ey:r,ez:n}=this,{ex:i,ey:f,ez:o}=t,s=d(e*o),a=d(i*n),l=d(r*o),h=d(f*n);return s===a&&l===h}is0(){return this.equals(S.ZERO)}negate(){return new S(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){let{a:t}=e,{ex:r,ey:n,ez:i}=this,f=d(r*r),o=d(n*n),s=d(tI*d(i*i)),a=d(t*f),l=r+n,h=d(d(l*l)-f-o),c=a+o,u=c-s,b=a-o,g=d(h*u),p=d(c*b),y=d(h*b);return new S(g,p,d(u*c),y)}add(t){w(t);let{a:r,d:n}=e,{ex:i,ey:f,ez:o,et:s}=this,{ex:a,ey:l,ez:h,et:c}=t;if(r===BigInt(-1)){let t=d((f-i)*(l+a)),e=d((f+i)*(l-a)),r=d(e-t);if(r===tm)return this.double();let n=d(o*tI*c),u=d(s*tI*h),b=u+n,g=e+t,p=u-n,y=d(b*r),w=d(g*p),B=d(b*p);return new S(y,w,d(r*g),B)}let u=d(i*a),b=d(f*l),g=d(s*n*c),p=d(o*h),y=d((i+f)*(a+l)-u-b),B=p-g,x=p+g,m=d(b-r*u),E=d(y*B),I=d(x*m),v=d(y*m);return new S(E,I,d(B*x),v)}subtract(t){return this.add(t.negate())}wNAF(t){return H.wNAFCached(this,t,S.normalizeZ)}multiply(t){L("scalar",t,tE,n);let{p:e,f:r}=this.wNAF(t);return S.normalizeZ([e,r])[0]}multiplyUnsafe(t){return L("scalar",t,tm,n),t===tm?O:this.equals(O)||t===tE?this:this.equals(A)?this.wNAF(t).p:H.unsafeLadder(this,t)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return H.unsafeLadder(this,n).is0()}toAffine(t){return B(this,t)}clearCofactor(){let{h:t}=e;return t===tE?this:this.multiplyUnsafe(t)}static fromHex(t,n=!1){let{d:i,a:f}=e,o=r.BYTES;t=I("pointHex",t,o),h("zip215",n);let s=t.slice(),a=t[o-1];s[o-1]=-129&a;let c=x(s);L("pointHex.y",c,tm,n?l:r.ORDER);let u=d(c*c),{isValid:g,value:p}=b(d(u-tE),d(i*u-f));if(!g)throw Error("Point.fromHex: invalid y coordinate");let y=(p&tE)===tE,w=!!(128&a);if(!n&&p===tm&&w)throw Error("Point.fromHex: x=0 and x_0=1");return w!==y&&(p=d(-p)),S.fromAffine({x:p,y:c})}static fromPrivateKey(t){return R(t).point}toRawBytes(){let{x:t,y:e}=this.toAffine(),n=E(e,r.BYTES);return n[n.length-1]|=t&tE?128:0,n}toHex(){return u(this.toRawBytes())}}S.BASE=new S(e.Gx,e.Gy,tE,d(e.Gx*e.Gy)),S.ZERO=new S(tm,tE,tE,tm);let{BASE:A,ZERO:O}=S,H=tn(S,8*s);function R(t){t=I("private key",t,s);let e=I("hashed private key",f(t),2*s),r=g(e.slice(0,s)),i=e.slice(s,2*s),o=j(x(r),n),a=A.multiply(o),l=a.toRawBytes();return{head:r,prefix:i,scalar:o,point:a,pointBytes:l}}function k(t=new Uint8Array,...e){return j(x(f(p(v(...e),I("context",t),!!i))),n)}return A._setWindowSize(8),{CURVE:e,getPublicKey:function(t){return R(t).pointBytes},sign:function(t,e,f={}){t=I("message",t),i&&(t=i(t));let{prefix:o,scalar:a,pointBytes:l}=R(e),d=k(f.context,o,t),h=A.multiply(d).toRawBytes(),c=j(d+k(f.context,h,l,t)*a,n);return L("signature.s",c,tm,n),I("result",v(h,E(c,r.BYTES)),2*s)},verify:function(t,e,n,f=tS){let o,s,a;let{context:l,zip215:d}=f,c=r.BYTES;t=I("signature",t,2*c),e=I("message",e),void 0!==d&&h("zip215",d),i&&(e=i(e));let u=x(t.slice(c,2*c));try{o=S.fromHex(n,d),s=S.fromHex(t.slice(0,c),d),a=A.multiplyUnsafe(u)}catch(t){return!1}if(!d&&o.isSmallOrder())return!1;let b=k(l,s.toRawBytes(),o.toRawBytes(),e);return s.add(o.multiplyUnsafe(b)).subtract(a).clearCofactor().equals(S.ZERO)},ExtendedPoint:S,utils:{getExtendedPublicKey:R,randomPrivateKey:()=>o(r.BYTES),precompute:(t=8,e=S.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}({a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:tP,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:tO,randomBytes:n.r,adjustScalarBytes:tG,domain:(t,e,r)=>{if(e.length>255)throw Error("Context is too big: "+e.length);return(0,n.c)((0,n.u)("SigEd448"),new Uint8Array([r?1:0,e.length]),e,t)},uvRatio:function(t,e){let r=j(t*t*e,tH),n=j(r*t,tH),i=j(n*r*e,tH),f=j(n*t_(i),tH),o=j(f*f,tH);return{isValid:j(o*e,tH)===t,value:f}}}),t$=function(t){let e=(q(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})),{P:r}=e,n=t=>j(t,r),i=e.montgomeryBits,f=Math.ceil(i/8),o=e.nByteLength,s=e.adjustScalarBytes||(t=>t),a=e.powPminus2||(t=>D(t,r-BigInt(2),r));function l(t,e,r){let i=n(t*(e-r));return[e=n(e-i),r=n(r+i)]}let d=(e.a-BigInt(2))/BigInt(4);function h(t,e){let h=function(t,e){L("u",t,tA,r),L("scalar",e,tA,r);let f,o=tL,s=tA,h=t,c=tL,u=tA;for(let r=BigInt(i-1);r>=tA;r--){let i=e>>r&tL;u^=i,o=(f=l(u,o,h))[0],h=f[1],s=(f=l(u,s,c))[0],c=f[1],u=i;let a=o+s,b=n(a*a),g=o-s,p=n(g*g),y=b-p,w=h+c,B=n((h-c)*a),x=n(w*g),m=B+x,E=B-x;h=n(m*m),c=n(t*n(E*E)),o=n(b*p),s=n(y*(b+n(d*y)))}return o=(f=l(u,o,h))[0],h=f[1],s=(f=l(u,s,c))[0],c=f[1],n(o*a(s))}(function(t){let e=I("u coordinate",t,f);return 32===o&&(e[31]&=127),x(e)}(e),function(t){let e=I("scalar",t),r=e.length;if(r!==f&&r!==o)throw Error(`Expected ${f} or ${o} bytes, got ${r}`);return x(s(e))}(t));if(h===tA)throw Error("Invalid private or public key received");return E(n(h),f)}let c=E(n(e.Gu),f);function u(t){return h(t,c)}return{scalarMult:h,scalarMultBase:u,getSharedSecret:(t,e)=>h(t,e),getPublicKey:t=>u(t),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:c}}({a:BigInt(156326),montgomeryBits:448,nByteLength:56,P:tH,Gu:BigInt(5),powPminus2:t=>j(V(t_(t),BigInt(2),tH)*t,tH),adjustScalarBytes:tG,randomBytes:n.r});tP.ORDER,BigInt(3),BigInt(4),BigInt(156326),BigInt("39082"),BigInt("78163"),BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let tZ=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),tj=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),tD=BigInt(1),tV=BigInt(2),tK=(t,e)=>(t+e/tV)/e,tM=W(tZ,void 0,void 0,{sqrt:function(t){let e=BigInt(3),r=BigInt(6),n=BigInt(11),i=BigInt(22),f=BigInt(23),o=BigInt(44),s=BigInt(88),a=t*t*t%tZ,l=a*a*t%tZ,d=V(l,e,tZ)*l%tZ,h=V(d,e,tZ)*l%tZ,c=V(h,tV,tZ)*a%tZ,u=V(c,n,tZ)*c%tZ,b=V(u,i,tZ)*u%tZ,g=V(b,o,tZ)*b%tZ,p=V(g,s,tZ)*g%tZ,y=V(p,o,tZ)*b%tZ,w=V(y,e,tZ)*l%tZ,B=V(w,f,tZ)*u%tZ,x=V(B,r,tZ)*a%tZ,m=V(x,tV,tZ);if(!tM.eql(tM.sqr(m),t))throw Error("Cannot find square root");return m}}),tY=tu({a:BigInt(0),b:BigInt(7),Fp:tM,n:tj,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-tD*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=BigInt("0x100000000000000000000000000000000"),f=tK(e*t,tj),o=tK(-r*t,tj),s=j(t-f*e-o*n,tj),a=j(-f*r-o*e,tj),l=s>i,d=a>i;if(l&&(s=tj-s),d&&(a=tj-a),s>i||a>i)throw Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:s,k2neg:d,k2:a}}}},n.s);BigInt(0),tY.ProjectivePoint;let tW=W(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),tX=tu({a:tW.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:tW,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},n.s),tJ=W(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),tQ=tu({a:tJ.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:tJ,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},n.a),t0=W(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),t1=new Map(Object.entries({nistP256:tg,nistP384:ty,nistP521:tx,brainpoolP256r1:tX,brainpoolP384r1:tQ,brainpoolP512r1:tu({a:t0.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:t0,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},n.d),secp256k1:tY,x448:t$,ed448:tT}))},33558:(t,e,r)=>{r.d(e,{C:()=>m,H:()=>w,M:()=>E,a:()=>V,b:()=>f,c:()=>y,d:()=>D,e:()=>s,f:()=>td,g:()=>I,h:()=>o,i:()=>c,j:()=>R,k:()=>ta,l:()=>tl,r:()=>x,s:()=>H,t:()=>p,u:()=>g,w:()=>B});/*! OpenPGP.js v6.0.0-beta.3.patch.1 - 2024-09-11 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */let n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, not "+t)}function f(t,...e){if(!(t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function o(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");i(t.outputLen),i(t.blockLen)}function s(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function a(t,e){f(t);let r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}let l="object"==typeof n&&"crypto"in n?n.crypto:void 0,d=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),h=(t,e)=>t<<32-e|t>>>e,c=(t,e)=>t<<e|t>>>32-e>>>0,u=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function b(t){var e;for(let r=0;r<t.length;r++)t[r]=(e=t[r])<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function g(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function p(t){return"string"==typeof t&&(t=g(t)),f(t),t}function y(...t){let e=0;for(let r=0;r<t.length;r++){let n=t[r];f(n),e+=n.length}let r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let i=t[e];r.set(i,n),n+=i.length}return r}class w{clone(){return this._cloneInto()}}function B(t){let e=e=>t().update(p(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function x(t=32){if(l&&"function"==typeof l.getRandomValues)return l.getRandomValues(new Uint8Array(t));if(l&&"function"==typeof l.randomBytes)return l.randomBytes(t);throw Error("crypto.getRandomValues must be defined")}let m=(t,e,r)=>t&e^~t&r,E=(t,e,r)=>t&e^t&r^e&r;class I extends w{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=d(this.buffer)}update(t){s(this);let{view:e,buffer:r,blockLen:n}=this,i=(t=p(t)).length;for(let f=0;f<i;){let o=Math.min(n-this.pos,i-f);if(o!==n)r.set(t.subarray(f,f+o),this.pos),this.pos+=o,f+=o,this.pos===n&&(this.process(e,0),this.pos=0);else{let e=d(t);for(;n<=i-f;f+=n)this.process(e,f)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){s(this),a(t,this),this.finished=!0;let{buffer:e,view:r,blockLen:n,isLE:i}=this,{pos:f}=this;e[f++]=128,this.buffer.subarray(f).fill(0),this.padOffset>n-f&&(this.process(r,0),f=0);for(let t=f;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);let i=BigInt(32),f=BigInt(4294967295),o=Number(r>>i&f),s=Number(r&f),a=n?4:0,l=n?0:4;t.setUint32(e+a,o,n),t.setUint32(e+l,s,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);let o=d(t),l=this.outputLen;if(l%4)throw Error("_sha2: outputLen should be aligned to 32bit");let h=l/4,c=this.get();if(h>c.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<h;t++)o.setUint32(4*t,c[t],i)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:n,finished:i,destroyed:f,pos:o}=this;return t.length=n,t.pos=o,t.finished=i,t.destroyed=f,n%e&&t.buffer.set(r),t}}let v=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),S=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),A=new Uint32Array(64);class L extends I{constructor(){super(64,32,8,!1),this.A=0|S[0],this.B=0|S[1],this.C=0|S[2],this.D=0|S[3],this.E=0|S[4],this.F=0|S[5],this.G=0|S[6],this.H=0|S[7]}get(){let{A:t,B:e,C:r,D:n,E:i,F:f,G:o,H:s}=this;return[t,e,r,n,i,f,o,s]}set(t,e,r,n,i,f,o,s){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|f,this.G=0|o,this.H=0|s}process(t,e){for(let r=0;r<16;r++,e+=4)A[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=A[t-15],r=A[t-2],n=h(e,7)^h(e,18)^e>>>3,i=h(r,17)^h(r,19)^r>>>10;A[t]=i+A[t-7]+n+A[t-16]|0}let{A:r,B:n,C:i,D:f,E:o,F:s,G:a,H:l}=this;for(let t=0;t<64;t++){let e=l+(h(o,6)^h(o,11)^h(o,25))+m(o,s,a)+v[t]+A[t]|0,d=(h(r,2)^h(r,13)^h(r,22))+E(r,n,i)|0;l=a,a=s,s=o,o=f+e|0,f=i,i=n,n=r,r=e+d|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,f=f+this.D|0,o=o+this.E|0,s=s+this.F|0,a=a+this.G|0,l=l+this.H|0,this.set(r,n,i,f,o,s,a,l)}roundClean(){A.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class O extends L{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}let H=B(()=>new L),R=B(()=>new O),k=BigInt(4294967296-1),F=BigInt(32);function U(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:f,l:o}=function(t,e=!1){return e?{h:Number(t&k),l:Number(t>>F&k)}:{h:0|Number(t>>F&k),l:0|Number(t&k)}}(t[i],e);[r[i],n[i]]=[f,o]}return[r,n]}let q=(t,e,r)=>t<<r|e>>>32-r,z=(t,e,r)=>e<<r|t>>>32-r,C=(t,e,r)=>e<<r-32|t>>>64-r,N=(t,e,r)=>t<<r-32|e>>>64-r,_={split:U,shrSH:(t,e,r)=>t>>>r,shrSL:(t,e,r)=>t<<32-r|e>>>r,rotrSH:(t,e,r)=>t>>>r|e<<32-r,rotrSL:(t,e,r)=>t<<32-r|e>>>r,rotrBH:(t,e,r)=>t<<64-r|e>>>r-32,rotrBL:(t,e,r)=>t>>>r-32|e<<64-r,add:function(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/4294967296|0)|0,l:0|i}},add3L:(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),add3H:(t,e,r,n)=>e+r+n+(t/4294967296|0)|0,add4L:(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),add4H:(t,e,r,n,i)=>e+r+n+i+(t/4294967296|0)|0,add5H:(t,e,r,n,i,f)=>e+r+n+i+f+(t/4294967296|0)|0,add5L:(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0)},[G,P]=_.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),T=new Uint32Array(80),$=new Uint32Array(80);class Z extends I{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:f,Dh:o,Dl:s,Eh:a,El:l,Fh:d,Fl:h,Gh:c,Gl:u,Hh:b,Hl:g}=this;return[t,e,r,n,i,f,o,s,a,l,d,h,c,u,b,g]}set(t,e,r,n,i,f,o,s,a,l,d,h,c,u,b,g){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|f,this.Dh=0|o,this.Dl=0|s,this.Eh=0|a,this.El=0|l,this.Fh=0|d,this.Fl=0|h,this.Gh=0|c,this.Gl=0|u,this.Hh=0|b,this.Hl=0|g}process(t,e){for(let r=0;r<16;r++,e+=4)T[r]=t.getUint32(e),$[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){let e=0|T[t-15],r=0|$[t-15],n=_.rotrSH(e,r,1)^_.rotrSH(e,r,8)^_.shrSH(e,r,7),i=_.rotrSL(e,r,1)^_.rotrSL(e,r,8)^_.shrSL(e,r,7),f=0|T[t-2],o=0|$[t-2],s=_.rotrSH(f,o,19)^_.rotrBH(f,o,61)^_.shrSH(f,o,6),a=_.rotrSL(f,o,19)^_.rotrBL(f,o,61)^_.shrSL(f,o,6),l=_.add4L(i,a,$[t-7],$[t-16]),d=_.add4H(l,n,s,T[t-7],T[t-16]);T[t]=0|d,$[t]=0|l}let{Ah:r,Al:n,Bh:i,Bl:f,Ch:o,Cl:s,Dh:a,Dl:l,Eh:d,El:h,Fh:c,Fl:u,Gh:b,Gl:g,Hh:p,Hl:y}=this;for(let t=0;t<80;t++){let e=_.rotrSH(d,h,14)^_.rotrSH(d,h,18)^_.rotrBH(d,h,41),w=_.rotrSL(d,h,14)^_.rotrSL(d,h,18)^_.rotrBL(d,h,41),B=d&c^~d&b,x=h&u^~h&g,m=_.add5L(y,w,x,P[t],$[t]),E=_.add5H(m,p,e,B,G[t],T[t]),I=0|m,v=_.rotrSH(r,n,28)^_.rotrBH(r,n,34)^_.rotrBH(r,n,39),S=_.rotrSL(r,n,28)^_.rotrBL(r,n,34)^_.rotrBL(r,n,39),A=r&i^r&o^i&o,L=n&f^n&s^f&s;p=0|b,y=0|g,b=0|c,g=0|u,c=0|d,u=0|h,({h:d,l:h}=_.add(0|a,0|l,0|E,0|I)),a=0|o,l=0|s,o=0|i,s=0|f,i=0|r,f=0|n;let O=_.add3L(I,S,L);r=_.add3H(O,E,v,A),n=0|O}({h:r,l:n}=_.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:f}=_.add(0|this.Bh,0|this.Bl,0|i,0|f)),({h:o,l:s}=_.add(0|this.Ch,0|this.Cl,0|o,0|s)),({h:a,l:l}=_.add(0|this.Dh,0|this.Dl,0|a,0|l)),({h:d,l:h}=_.add(0|this.Eh,0|this.El,0|d,0|h)),({h:c,l:u}=_.add(0|this.Fh,0|this.Fl,0|c,0|u)),({h:b,l:g}=_.add(0|this.Gh,0|this.Gl,0|b,0|g)),({h:p,l:y}=_.add(0|this.Hh,0|this.Hl,0|p,0|y)),this.set(r,n,i,f,o,s,a,l,d,h,c,u,b,g,p,y)}roundClean(){T.fill(0),$.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class j extends Z{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}let D=B(()=>new Z),V=B(()=>new j),K=[],M=[],Y=[],W=BigInt(0),X=BigInt(1),J=BigInt(2),Q=BigInt(7),tt=BigInt(256),te=BigInt(113);for(let t=0,e=X,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],K.push(2*(5*n+r)),M.push((t+1)*(t+2)/2%64);let i=W;for(let t=0;t<7;t++)(e=(e<<X^(e>>Q)*te)%tt)&J&&(i^=X<<(X<<BigInt(t))-X);Y.push(i)}let[tr,tn]=U(Y,!0),ti=(t,e,r)=>r>32?C(t,e,r):q(t,e,r),tf=(t,e,r)=>r>32?N(t,e,r):z(t,e,r);class to extends w{constructor(t,e,r,n=!1,f=24){var o;if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=f,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,i(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=new Uint32Array((o=this.state).buffer,o.byteOffset,Math.floor(o.byteLength/4))}keccak(){u||b(this.state32),function(t,e=24){let r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){let n=(e+8)%10,i=(e+2)%10,f=r[i],o=r[i+1],s=ti(f,o,1)^r[n],a=tf(f,o,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=s,t[e+r+1]^=a}let e=t[2],i=t[3];for(let r=0;r<24;r++){let n=M[r],f=ti(e,i,n),o=tf(e,i,n),s=K[r];e=t[s],i=t[s+1],t[s]=f,t[s+1]=o}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=tr[n],t[1]^=tn[n]}r.fill(0)}(this.state32,this.rounds),u||b(this.state32),this.posOut=0,this.pos=0}update(t){s(this);let{blockLen:e,state:r}=this,n=(t=p(t)).length;for(let i=0;i<n;){let f=Math.min(e-this.pos,n-i);for(let e=0;e<f;e++)r[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,128&e&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){s(this,!1),f(t),this.finish();let e=this.state,{blockLen:r}=this;for(let n=0,i=t.length;n<i;){this.posOut>=r&&this.keccak();let f=Math.min(r-this.posOut,i-n);t.set(e.subarray(this.posOut,this.posOut+f),n),this.posOut+=f,n+=f}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return i(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(a(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:e,suffix:r,outputLen:n,rounds:i,enableXOF:f}=this;return t||(t=new to(e,r,n,f,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=n,t.enableXOF=f,t.destroyed=this.destroyed,t}}let ts=(t,e,r)=>B(()=>new to(e,t,r)),ta=ts(6,136,32),tl=ts(6,72,64),td=function(t){let e=(e,r)=>t(r).update(p(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e}((t={})=>new to(136,31,void 0===t.dkLen?32:t.dkLen,!0))}}]);
